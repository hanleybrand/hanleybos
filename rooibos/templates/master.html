{% load ui %}
{% load help %}
{% load analytics %}
{% load humanize %}
{% load compress %}
{% load userprofile %}
{% load access_control %}
{% load static %}

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <script type="text/javascript">
        document.documentElement.className = 'js-enabled';
        var profile_settings = {% profile_settings ui %};
        var basket_open = profile_settings['ui_basket_open'] == 'true';
        if (basket_open) document.documentElement.className = 'js-enabled basket-open';
        var custom_process_facets = false;
    </script>
    <title>MDID{% block title %}{% endblock %}</title>
    <link rel="shortcut icon" href="{% if FAVICON_URL %}{{ FAVICON_URL }}{% else %}{% url static 'images/favicon.ico' %}{% endif %}" />
{% block stylesheets %}
{% compress css %}
    <link href="{% url static 'css/reset.css' %}" rel="stylesheet" type="text/css" media="screen">
    <link href="{% url static 'css/typography.css' %}" rel="stylesheet" type="text/css" media="screen">
    <link href="{% url static 'jquery/jquery.autocomplete.css' %}" rel="stylesheet" type="text/css" media="screen">
    <link href="{% url static 'jquery/jquery-ui-1.8.11.custom.css' %}" rel="stylesheet" type="text/css" media="screen">
    {% include "master.css" %}
{% endcompress %}
<!--[if IE]>
{% compress css %}
    {% include "master-ie.css" %}
{% endcompress %}
<![endif]-->
{% endblock %}
</head>

<body class="ui-reset master">

{% block raw-content %}
    <div id="content-wrapper">
        <div id="content">




{% block basket %}
{% spaceless %}
<div id="basket-content">
    <div id="basket-scroll-right"></div>
    <div id="basket-scroll-left"></div>
    <div id="basket-thumbs">{% include "ui_basket.html" %}</div>
</div>
{% endspaceless %}
{% endblock %}

<div style="height: 15px;"></div>


{% if messages %}
<div id="messages">
    {% for message in messages %}
    <span>{{ message }}</span><br />
    {% endfor %}
</div>
{% endif %}

{% block content-top %}
{% endblock %}

<div id="sidebar">
{% block sidebar %}
{% include "ui_related_pages.html" %}
{% endblock %}
</div>

{% block content %}
{% endblock %}

{% block footer %}
            <div id="footer">
                {{ COPYRIGHT|default:"Copyright 1997-2012 James Madison University" }}
            </div>
{% endblock %}

        </div>
    </div>
{% endblock %}

<div id="preview-dialog" style="display: none;" class="ui-corner-all"></div>



{% block header %}
{% spaceless %}
    <div id="topmenu">
        <ul>
            {% if user.is_authenticated %}
            <li>Welcome{% if user.first_name %}, {{ user.first_name }}{% endif %}</li>
            <li><a href="{% url logout %}?next={% url main %}">Log out</a></li>
            <li><a href="{% url ui-options %}">Options</a></li>
            <li><a href="{% url ui-management %}">Management</a></li>
            {% else %}
            <li><a href="{% url login %}?next={{ request.get_full_path }}">Log in</a></li>
            {% endif %}
            <li>{% with request.pagehelp|default:"" as help %}{% pagehelp help %}{% endwith %}</li>
            {% if ADMINS %}
            <li><a href="{% url ui-report-problem %}">Report a Problem</a></li>
            {% endif %}
        </ul>
        <span id="javascriptwarning">You have JavaScript disabled.  MDID works better with JavaScript enabled.</span>
    </div>

    <div id="header-bar">
        <div class="spacer">
            <div id="header">
                <a href="{% url main %}" id="logo"></a>
                <ul style="float: right;">
                    <li><div id="basket-header">{% include "ui_basket_header.html" %}</div>
                        <ul class="menu">
                            <li><a id="basket-toggle" href="#">Hide</a></li>
                            <li><a href="{% url solr-selected %}">Explore</a></li>
                            <li><a href="{% url ui-clear-selected %}?next={{ request.get_full_path|urlencode }}">Clear</a></li>
                        </ul>
                    </li>
                </ul>

                <ul>
                    <li><a href="{% url solr-search %}">Discover</a>
                        <ul class="menu">
                            <li><a href="{% url solr-search %}">Explore</a></li>
                            <li><a href="{% url solr-searchform %}">Advanced Search</a></li>
                            <li><a href="{% url solr-browse %}">Browse</a></li>
                            <li><a href="{% url solr-overview %}">Overview</a></li>
                        </ul>
                    </li>
                    {% if user.is_authenticated %}
                    <li><a href="{% url presentation-manage %}">Organize</a>
                        <ul class="menu">
                            {% if current_presentation.id %}
                            <li><a href="{% url presentation-edit current_presentation.id, current_presentation.name %}">Edit {{ current_presentation.title }}</a></li>
                            {% endif %}
                            <li><a href="{% url presentation-manage %}">Your Presentations</a></li>
                            <li><a href="{% url solr-search %}?c=ownedtag:{{ user.id }}-favorite">Your Favorites</a></li>
                            <li><a href="{% url solr-search %}?c=owner:{{ user.id }}">Your Content</a></li>
                            {% if user|accessible_objects:"data.Collection,r"|length %}
                            <li><a href="{% url data-record-new-personal %}">Create Item</a></li>
                            {% endif %}
                            {% if user|accessible_objects:"data.Collection,rw"|length %}
                            <li><a href="{% url data-record-new %}">Create Collection Item</a></li>
                            {% endif %}
                            <li><a href="{% url presentation-create %}">Create Presentation</a></li>
                        </ul>
                    </li>
                    {% endif %}
                    <li><a href="{% url presentation-browse %}">Experience</a>
                        <ul class="menu">
                            <li><a href="{% url presentation-browse %}">Browse Presentations</a></li>
                            <li><a href="{% url showcases %}">Showcases</a></li>
                            {% if user.is_authenticated %}
                            <li><a href="{% url mediaviewer-install %}">MediaViewer</a></li>
                            {% endif %}
                            <li><a href="{% url about %}">About</a></li>
                        </ul>
                    </li>
                    <li class="search" style="padding-right: 20px;"><span>Search</span>
                        <form method="GET" action="{% url solr-search %}">
                            <input id="quicksearch" name="kw" type="text" title="Search" /><input type="image" src="{% url static 'images/go.png' %}" id="search-go" />
                        </form>
                    </li>
                </ul>
            </div>
        </div>
    </div>
{% endspaceless %}
{% endblock %}

<!--
<div id="related-images-bar" style="display: none;">
    <div id="related-images-bar-toggle">
        <div id="related-images-bar-hide" style="float: right;"></div>
        <span id="related-images-bar-hint"></span>
        <span id="related-images-bar-all" style="margin-left: 20px; "></span>
    </div>
    <div id="related-images-bar-content"></div>
</div>
<div id="related-images-bar-placeholder" style="visibility: hidden;"></div>
-->

{% analytics %}

{% if debug %}<!--
{{ sql_queries|length }} queries:
{% for q in sql_queries %}
{{ q.sql }} ({{ q.time }})
{% endfor %}
-->
<div id="stats"><!-- STATS: Total: %(totTime).2fs <br/>Python: %(pyTime).2fs <br/>DB: %(dbTime).2fs <br/>Queries: %(queries)d --></div>
{% endif %}

{% block javascript %}
{% compress js %}
    <script>

     var mdid = {
         //initializes mdid.js as a no-dependency javascript object
        debug : true,
        apiSelectRecord: '{% url ui-api-select-record %}',
        dataRecordPreview: '{% url data-record-preview 0 %}',
        URLprofileStore: '{% url userprofile-store %}',
        staticUrl : '{% get_static_prefix %}'
    }

    </script>
    <script type="text/javascript" src="{% url static 'js/jquery-1.8.3.js' %}"></script>
    <script type="text/javascript" src="{% url static 'jquery/jquery-ui-1.8.11.custom.min.js' %}"></script>
    <script type="text/javascript" src="{% url static 'jquery/jquery.cookie.js' %}"></script>
    <script type="text/javascript" src="{% url static 'jquery/jquery.hoverIntent.minified.js' %}"></script>
    <script type="text/javascript" src="{% url static 'jquery/jquery.ajaxmanager.js' %}"></script>
    <script type="text/javascript" src="{% url static 'jquery/jquery.autocomplete.pack.js' %}"></script>
    <script type="text/javascript" src="{% url static 'jquery/jquery.scrollTo-1.4.2-min.js' %}"></script>
    <script type="text/javascript" src="{% url static 'jquery/jquery.multicheckbox.js' %}"></script>
    <script type="text/javascript" src="{% url static 'swfupload/swfupload.js' %}"></script>
    <script type="text/javascript" src="{% url static 'swfupload/plugins/swfupload.cookies.js' %}"></script>
    <script type="text/javascript" src="{% url static 'jquery/jquery.swfupload.js' %}"></script>
    <script type="text/javascript" src="{% url static 'jquery/qtip/jquery.qtip-1.0.0-rc3.min.js' %}"></script>
    <script type="text/javascript">
        var ajaxManager = $.manageAjax.create('defaultQueue', { queue: true });
        var ajaxInteractionManager = $.manageAjax.create('interactionQueue', { queue: true });
    </script>
    <script type="text/javascript" src="{% url static 'scripts/ui-scripts.js' %}"></script>
    <script type="text/javascript" src="{% url static 'scripts/json2.js' %}"></script>

    <script type="text/javascript" src="{% url static 'scripts/master.js' %}"></script>

    <!--<script type="text/javascript" src="{% url static 'scripts/related-images-bar.js' %}"></script>-->
    <!--<script type="text/javascript" src="/jsi18n/"></script>-->

{% endcompress %}

{% endblock %}

{{ CUSTOM_TRACKER_HTML|safe }}

</body>

</html>
